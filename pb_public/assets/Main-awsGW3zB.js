import{r,c as d,b as m,a as t,e as p,I as x,F as v,f as D,u as g,d as F,o as u,j as w,k as C,R as S}from"./index-DhUzF4e6.js";import{v as q}from"./utils-RVpx9FsL.js";import{c as B,a as _}from"./index.esm-DyswK6GF.js";import{B as V}from"./BreadCrumb-QusY3eB5.js";import{L}from"./ListDisplay-B9BmHlNl.js";import"./index-Dh1WwN9N.js";import"./forms-Lc3CRwVw.js";import"./sweetalert2.esm.all-CIewtpap.js";const P=B().shape({from_date:_().matches(/^\d{4}-\d{2}-\d{2}$/,"Date must be in the format yyyy-mm-dd").required("leave_from is a required field"),to_date:_().matches(/^\d{4}-\d{2}-\d{2}$/,"Date must be in the format yyyy-mm-dd").required("leave_to is a required field").test("is-greater","leave_to must be equal or greater than leave_from",function(s){const{from_date:l}=this.parent;return!l||!s||new Date(s)>=new Date(l)})});function E(s){return s==="single"?[{name:"employee",label:"Employee",collection:"employee",labelField:"full_name",firstOption:"select employee",type:"relational_field_select",isCombinedField:!0,combinedFields:["first_name","middle_name","last_name"],required:!0},{name:"from_date",label:"From Date",type:"date",placeholder:"2001-01-01"},{name:"to_date",label:"To Date",type:"date",placeholder:"2001-01-01"}]:s==="bulk"?[{name:"from_date",label:"From Date",type:"date",placeholder:"2001-01-01"},{name:"to_date",label:"To Date",type:"date",placeholder:"2001-01-01"}]:[]}const R={class:"is-flex is-flex-direction-row-reverse mb-4"},A={class:"card"},N={class:"card-content"},T={key:0,class:"modal is-active"},H={class:"card"},M={class:"card-content"},I={class:"columns is-multiline"},z={class:"column"},j={__name:"Main",setup(s){const l=r(!1),c=r({}),i=r("single"),b=C(),h=r([{name:"employee",label:"Employee",type:"expand",expandCollection:"employee",expandLabel:"full_name"},{name:"from_date",label:"From Date",type:"date"},{name:"to_date",label:"To Date",type:"date"},{name:"view",label:"View",type:"custom_component",component:{props:{item:Object},render(){return m(S,{to:`/payroll/payslip?id=${this.item.id}&employee=${this.item.employee}&full_name=${this.item.expand.employee.full_name}`,class:"button is-small is-dark"},{default:()=>[p("âš²")]})}}}]),k=r([{name:"text_search",label:"Search",type:"text_search",fields:["employee.first_name","employee.middle_name","employee.last_name"],placeholder:"search"}]);async function $(n){const e=n.target,o=new FormData(e),a=Object.fromEntries(o.entries());if(i.value==="single"&&a.employee===void 0||a.employee===""){c.value={employee:"required fields"};return}const y=await q(a,P);if(y!==!0){c.value=y;return}b.push(`/payroll/add?type=${i.value}&employee=${a==null?void 0:a.employee}&from_date=${a==null?void 0:a.from_date}&to_date=${a==null?void 0:a.to_date}`)}function f(n){i.value=n,l.value=!0}return(n,e)=>(u(),d(v,null,[m(V,{links:[{path:"/",label:"Dashboard",isActive:!1},{path:"/payroll",label:"Payroll",isActive:!0}]}),t("div",R,[t("button",{class:"button is-secondary ml-3",onClick:e[0]||(e[0]=o=>f("bulk"))},e[4]||(e[4]=[t("i",{class:"bi bi-plus-circle px-1"},null,-1),p("Bulk Payroll ")])),t("button",{class:"button is-dark",onClick:e[1]||(e[1]=o=>f("single"))},e[5]||(e[5]=[t("i",{class:"bi bi-plus-circle px-1"},null,-1),p("Add Payroll ")]))]),t("div",A,[t("div",N,[m(L,{listHeader:h.value,filter:k.value,expand:"employee",collection:"payroll"},null,8,["listHeader","filter"])])]),l.value?(u(),d("div",T,[t("div",{class:"modal-background",onClick:e[2]||(e[2]=o=>l.value=!1)}),t("div",H,[t("div",M,[t("form",{novalidate:"",onSubmit:x($,["prevent"])},[t("div",I,[(u(!0),d(v,null,D(g(E)(i.value),o=>(u(),d("div",z,[m(w,{form:o,errors:c.value},null,8,["form","errors"])]))),256)),e[6]||(e[6]=t("div",{class:"column is-12"},[t("button",{class:"button is-dark"},"Submit")],-1))])],32)])]),t("button",{class:"modal-close is-large","aria-label":"close",onClick:e[3]||(e[3]=o=>l.value=!1)})])):F("",!0)],64))}};export{j as default};
