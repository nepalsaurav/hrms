import{r as n,c as d,d as u,a as e,y as w,F as x,f as C,o as m,h as F}from"./index-C7IYLqTz.js";import{B as O,c as f}from"./BreadCrumb-TF3kDMJB.js";import{R as A}from"./RenderForms-DFjF9nMb.js";import{a as _,b as B}from"./utils-cUNVy0Hq.js";import{S as p}from"./sweetalert2.esm.all-DPo3DB14.js";import"./index.esm-CWnM2rkH.js";const E={class:"container"},S={class:"card"},V={class:"card-content"},j=["disabled"],D={class:"columns is-multiline"},q={class:"column is-4"},P={__name:"CheckOut",setup(L){const h=[{name:"employee",label:"Employee",collection:"employee",labelField:"first_name",firstOption:"select employee",type:"relational_field_select",isCombinedField:!0,combinedFields:["first_name","middle_name","last_name"],required:!0},{name:"check_out_time",label:"Check Out Time",type:"text",disabled:!0}],i=n(!1),r=n({}),b=F(),v={check_out_time:_()};async function k(l){const a=l.target,o=new FormData(a);let c=Object.fromEntries(o.entries());i.value=!0;try{if(c.employee===void 0){r.value.employee="required fields";return}const s=`${B()} 00:00:00.000Z`,t=await f.collection("check_in").getFirstListItem(`employee='${c.employee}'&&date='${s}'`);if(t.check_out_time!==""){r.value.employee="already checkout";return}t.check_out_time=_(),await f.collection("check_in").update(t.id,t),p.fire({title:"success!",text:"check out added",icon:"success"}),b.push("/attendance")}catch(s){if(s.data.message==="The requested resource wasn't found."&&p.fire({title:"error!",text:"please! first do check in",icon:"error"}),s.data.data){const t={};Object.entries(s.data.data).forEach(([y,g])=>{t[y]=g.message}),r.value=t}}finally{i.value=!1}}return(l,a)=>(m(),d("div",E,[u(O,{links:[{path:"/",label:"Dashboard",isActive:!1},{path:"/attendance",label:"Attendance",isActive:!1},{path:"/attendance/checkout",label:"Check Out",isActive:!0}]}),e("div",S,[e("div",V,[e("form",{novalidate:"",onSubmit:w(k,["prevent"])},[e("fieldset",{disabled:i.value},[a[0]||(a[0]=e("legend",{class:"has-text-weight-bold"}," Add Check In ",-1)),a[1]||(a[1]=e("div",{class:"is-flex is-flex-direction-row-reverse"},[e("button",{class:"button is-dark",type:"submit"}," Save ")],-1)),e("div",D,[(m(),d(x,null,C(h,o=>e("div",q,[u(A,{form:o,errors:r.value,defaultValue:v[o.name]},null,8,["form","errors","defaultValue"])])),64))])],8,j)],32)])])]))}};export{P as default};
