import{r as n,i as O,c as l,d as k,a as s,j as V,k as v,F as p,f as b,t as S,o as a,n as w,g as L,v as R,u as T,l as N,h as P}from"./index-C7IYLqTz.js";import{L as $}from"./LoadingSkeleton-DhLAkGpz.js";import{B as z,c as D}from"./BreadCrumb-TF3kDMJB.js";import{v as I,g as J,f as E,a as M}from"./forms-uoaoRhcW.js";import{R as q}from"./RenderForms-DFjF9nMb.js";import{t as G}from"./utils-cUNVy0Hq.js";import{S as x}from"./sweetalert2.esm.all-DPo3DB14.js";import"./index.esm-CWnM2rkH.js";const H={class:"container"},K={class:"card"},Q={class:"card-content"},U={class:"tabs"},W=["onClick"],X={class:"columns is-multiline"},Y={key:2},ie={__name:"Edit",setup(Z){const _=N(),B=P(),m=n(!1),u=n(null),d=n(null),c=n("personal_details"),h=n({}),y=n([{label:"Dashboard",path:"/",isActive:!1},{label:"Employee",path:"/employee",isActive:!1},{label:"Edit",path:"/employee",isActive:!1}]),g=n([{name:"personal_details",label:"Personal Details"},{name:"contact_details",label:"Contact Details"},{name:"job_details",label:"Job Details"},{name:"payroll_and_benifits",label:"Payroll and Benefits"},{name:"additional_information",label:"Additional Information"}]);O(()=>_.params.id,C,{immediate:!0});async function C(o){d.value=null,u.value=null,m.value=!0,console.log(o);try{const e=await D.collection("employee").getOne(o);y.value.push({label:e.first_name,path:`/employee/edit/${e.id}`,isActive:!0}),u.value=e}catch(e){e.value=e.data.message}finally{m.value=!1}}function F(o){c.value=o}async function j(o){o.preventDefault();const e=o.target,t=new FormData(e);let r=Object.fromEntries(t.entries());r=G(r);const f=await I(Object.fromEntries(r.entries()),M);if(f!=!0){h.value=f;const i=J(c.value,E,f);i!=null&&(c.value=i);return}try{const i=await D.collection("employee").update(_.params.id,t);console.log(i),x.fire({title:"Success!",text:"Successfully edited employee",icon:"success",confirmButtonColor:"#171717"}),B.push("/employee")}catch(i){const A=i.data.message;x.fire({title:"Error!",text:A,icon:"error"})}}return(o,e)=>(a(),l("div",H,[k(z,{links:y.value},null,8,["links"]),s("div",K,[s("div",Q,[m.value?(a(),V($,{key:0})):v("",!0),u.value!=null?(a(),l("form",{key:1,novalidate:"",onSubmit:j},[e[0]||(e[0]=s("legend",{class:"has-text-weight-bold"},"Add Employee",-1)),e[1]||(e[1]=s("div",{class:"is-flex is-flex-direction-row-reverse"},[s("button",{class:"button is-dark",type:"submit"}," Save ")],-1)),s("div",U,[s("ul",null,[(a(!0),l(p,null,b(g.value,t=>(a(),l("li",{class:w(t.name===c.value&&"is-active")},[s("a",{onClick:r=>F(t.name)},S(t.label),9,W)],2))),256))])]),(a(!0),l(p,null,b(g.value,t=>(a(),l("div",null,[L(s("div",X,[(a(!0),l(p,null,b(T(E)[t.name],r=>(a(),l("div",{class:w(["column",r.type==="rich_text"?"is-12":"is-4"])},[k(q,{form:r,errors:h.value,defaultValue:u.value[r.name]},null,8,["form","errors","defaultValue"])],2))),256))],512),[[R,t.name===c.value]])]))),256))],32)):v("",!0),d.value!=null?(a(),l("p",Y,S(d.value),1)):v("",!0)])])]))}};export{ie as default};
