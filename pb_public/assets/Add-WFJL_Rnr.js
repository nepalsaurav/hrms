import{_ as U,r as u,x as q,g,c as n,b as N,a as e,I as f,t as _,d as h,F as b,f as k,o as r,h as y,O as x,y as D,e as E,k as F}from"./index-DhUzF4e6.js";import{B as O}from"./BreadCrumb-QusY3eB5.js";import{S as R}from"./sweetalert2.esm.all-CIewtpap.js";const L={class:"card"},j={class:"card-content"},I=["disabled"],T={class:"columns is-multiline"},P={class:"column is-12"},$={key:0,class:"has-text-danger mt-2"},z={class:"column is-12"},G={class:"column"},H=["onUpdate:modelValue"],J={key:0,id:"name_options"},K=["value"],Q={class:"column"},W=["onUpdate:modelValue"],X={class:"column"},Y={class:"checkbox"},Z=["onUpdate:modelValue","onChange"],ee={class:"column is-narrow"},te=["onClick"],ae={key:0,class:"has-text-danger mt-2"},se={class:"is-flex is-flex-direction-row-reverse"},oe={__name:"Add",setup(le){const i=u([{name:"",amount:0,calculated:!1}]),p=u([]),m=u([]);u({});const S=u([]),c=u({}),v=u(!1),w=F();q(async()=>{try{const o=await g.collection("salary_component").getFullList({});m.value=o,p.value=o,S.value=p.map(t=>t.abbreviation)}catch{}});function A(o){return p.value.length>0?p.value.filter(s=>s.name===o):[]}function C(){i.value.forEach(o=>{if(o.name!==""){const t=m.value.filter(s=>s.name!==o.name);m.value=t}}),i.value.push({name:"",amount:0,calculated:!1})}function V(o){i.value.length>1&&i.value.splice(o,1)}function B(o){const t=o.target,s=new FormData(t);let d=Object.fromEntries(s.entries());console.log(d,i.value),d.name===""&&(c.value.name="required field");const a=[];i.value.forEach(l=>{l.component=A(l.name)[0].id,a.push(l)}),a.length===0&&(c.value.components="required field");const M=a.map(l=>(l.amount===void 0&&(l.amount=0),l));v.value=!0;try{const l=g.collection("salary_structure").create({name:d.name,components:M});R.fire({title:"Success!",text:"successfully created",icon:"success"}),w.push("/payroll/salary_structure")}catch(l){console.log(l)}finally{v.value=!1}}return(o,t)=>(r(),n(b,null,[N(O,{links:[{label:"Dashboard",path:"/",isActive:!1},{label:"Payroll",path:"/payroll",isActive:!0},{label:"Salary Structure",path:"/payroll/salary_structure",isActive:!1},{label:"Add",path:"/payroll/salary_structure/add",isActive:!0}]}),e("div",L,[e("div",j,[e("form",{novalidate:"",onSubmit:f(B,["prevent"])},[e("fieldset",{disabled:v.value},[t[4]||(t[4]=e("legend",{class:"has-text-weight-bold"}," Add Salary Structure ",-1)),t[5]||(t[5]=e("div",{class:"is-flex is-flex-direction-row-reverse"},[e("button",{class:"button is-dark",type:"submit"}," Save ")],-1)),e("div",T,[e("div",P,[t[0]||(t[0]=e("label",{for:"name",class:"label"},"Name*",-1)),t[1]||(t[1]=e("input",{type:"text",class:"input",id:"name",name:"name",required:""},null,-1)),c.value.name!==void 0?(r(),n("p",$,_(c.value.name),1)):h("",!0)]),e("div",z,[t[3]||(t[3]=e("label",{class:"label"},"Components*",-1)),(r(!0),n(b,null,k(i.value,(s,d)=>(r(),n("div",{key:d,class:"columns"},[e("div",G,[y(e("input",{type:"text",class:"input","onUpdate:modelValue":a=>s.name=a,placeholder:"Salary component",list:"name_options",required:""},null,8,H),[[x,s.name]]),m.value.length>0?(r(),n("datalist",J,[(r(!0),n(b,null,k(m.value,a=>(r(),n("option",{value:a.name},_(a.name),9,K))),256))])):h("",!0)]),e("div",Q,[y(e("input",{type:"number",class:"input","onUpdate:modelValue":a=>s.amount=a,placeholder:"Amount",required:""},null,8,W),[[x,s.amount]])]),e("div",X,[e("label",Y,[y(e("input",{type:"checkbox",class:"custom-checkbox","onUpdate:modelValue":a=>s.calculated=a,onChange:a=>{a.target.checked&&(s.amount=0)}},null,40,Z),[[D,s.calculated]]),t[2]||(t[2]=E(" Based on formula "))])]),e("div",ee,[e("button",{class:"button is-danger is-small mt-1",onClick:f(a=>V(d),["prevent"])}," Remove ",8,te)]),c.value.components!==void 0?(r(),n("p",ae,_(c.value.components),1)):h("",!0)]))),128)),e("div",se,[e("button",{class:"button is-dark is-small",onClick:f(C,["prevent"])}," Add ")])])])],8,I)],32)])])],64))}},ue=U(oe,[["__scopeId","data-v-6bb2f0f0"]]);export{ue as default};
