import{r as n,i as V,c as l,d as k,a as s,j as L,k as p,F as m,f as b,t as S,o as a,n as w,g as O,v as R,u as T,l as N,h as P}from"./index-7R5MiFNN.js";import{L as $}from"./LoadingSkeleton-BnsbOEAN.js";import{B as z,c as D}from"./BreadCrumb-DXLpQOAS.js";import{t as I,v as J,g as M,f as E,a as q}from"./forms-CzZlnoB6.js";import{R as G}from"./RenderForms-DhWJMHO2.js";import{S as x}from"./sweetalert2.esm.all-CIewtpap.js";import"./_commonjsHelpers-CqkleIqs.js";const H={class:"card"},K={class:"card-content"},Q={class:"tabs"},U=["onClick"],W={class:"columns is-multiline"},X={key:2},re={__name:"Edit",setup(Y){const _=N(),B=P(),d=n(!1),u=n(null),v=n(null),c=n("personal_details"),h=n({}),y=n([{label:"Dashboard",path:"/",isActive:!1},{label:"Employee",path:"/employee",isActive:!1},{label:"Edit",path:"/employee",isActive:!1}]),g=n([{name:"personal_details",label:"Personal Details"},{name:"contact_details",label:"Contact Details"},{name:"job_details",label:"Job Details"},{name:"payroll_and_benifits",label:"Payroll and Benefits"},{name:"additional_information",label:"Additional Information"}]);V(()=>_.params.id,F,{immediate:!0});async function F(o){v.value=null,u.value=null,d.value=!0,console.log(o);try{const e=await D.collection("employee").getOne(o);y.value.push({label:e.first_name,path:`/employee/edit/${e.id}`,isActive:!0}),u.value=e,console.log(e)}catch(e){e.value=e.data.message}finally{d.value=!1}}function A(o){c.value=o}async function C(o){o.preventDefault();const e=o.target,r=new FormData(e);let t=Object.fromEntries(r.entries());t=I(t);const f=await J(t,q);if(f!=!0){h.value=f;const i=M(c.value,E,f);i!=null&&(c.value=i);return}try{const i=await D.collection("employee").update(_.params.id,t);console.log(i),x.fire({title:"Success!",text:"Successfully edited employee",icon:"success"}),B.push("/employee")}catch(i){const j=i.data.message;x.fire({title:"Error!",text:j,icon:"error"})}}return(o,e)=>(a(),l(m,null,[k(z,{links:y.value},null,8,["links"]),s("div",H,[s("div",K,[d.value?(a(),L($,{key:0})):p("",!0),u.value!=null?(a(),l("form",{key:1,novalidate:"",onSubmit:C},[e[0]||(e[0]=s("legend",{class:"has-text-weight-bold"},"Add Employee",-1)),e[1]||(e[1]=s("div",{class:"is-flex is-flex-direction-row-reverse"},[s("button",{class:"button is-dark",type:"submit"},"Save")],-1)),s("div",Q,[s("ul",null,[(a(!0),l(m,null,b(g.value,r=>(a(),l("li",{class:w(r.name===c.value&&"is-active")},[s("a",{onClick:t=>A(r.name)},S(r.label),9,U)],2))),256))])]),(a(!0),l(m,null,b(g.value,r=>(a(),l("div",null,[O(s("div",W,[(a(!0),l(m,null,b(T(E)[r.name],t=>(a(),l("div",{class:w(["column",t.type==="rich_text"?"is-12":"is-4"])},[k(G,{form:t,errors:h.value,defaultValue:u.value[t.name]},null,8,["form","errors","defaultValue"])],2))),256))],512),[[R,r.name===c.value]])]))),256))],32)):p("",!0),v.value!=null?(a(),l("p",X,S(v.value),1)):p("",!0)])])],64))}};export{re as default};
