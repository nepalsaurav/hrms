import{r as n,c as d,b as u,a as e,I as w,F as x,f as C,o as m,j as F,k as O,g as f}from"./index-DhUzF4e6.js";import{B as j}from"./BreadCrumb-QusY3eB5.js";import{l as _,m as A}from"./utils-RVpx9FsL.js";import{S as p}from"./sweetalert2.esm.all-CIewtpap.js";import"./index.esm-DyswK6GF.js";const B={class:"container"},E={class:"card"},S={class:"card-content"},V=["disabled"],D={class:"columns is-multiline"},q={class:"column is-4"},M={__name:"CheckOut",setup(I){const h=[{name:"employee",label:"Employee",collection:"employee",labelField:"first_name",firstOption:"select employee",type:"relational_field_select",isCombinedField:!0,combinedFields:["first_name","middle_name","last_name"],required:!0},{name:"check_out_time",label:"Check Out Time",type:"text",disabled:!0}],i=n(!1),r=n({}),b=O(),v={check_out_time:_()};async function k(l){const a=l.target,o=new FormData(a);let c=Object.fromEntries(o.entries());i.value=!0;try{if(c.employee===void 0){r.value.employee="required fields";return}const s=`${A()} 00:00:00.000Z`,t=await f.collection("check_in").getFirstListItem(`employee='${c.employee}'&&date='${s}'`);if(console.log(t),t.check_out_time!==""){r.value.employee="already checkout";return}t.check_out_time=_(),await f.collection("check_in").update(t.id,t),p.fire({title:"success!",text:"check out added",icon:"success"}),b.push("/attendance")}catch(s){if(s.data.message==="The requested resource wasn't found."&&p.fire({title:"error!",text:"please! first do check in",icon:"error"}),s.data.data){const t={};Object.entries(s.data.data).forEach(([y,g])=>{t[y]=g.message}),r.value=t}}finally{i.value=!1}}return(l,a)=>(m(),d("div",B,[u(j,{links:[{path:"/",label:"Dashboard",isActive:!1},{path:"/attendance",label:"Attendance",isActive:!1},{path:"/attendance/checkout",label:"Check Out",isActive:!0}]}),e("div",E,[e("div",S,[e("form",{novalidate:"",onSubmit:w(k,["prevent"])},[e("fieldset",{disabled:i.value},[a[0]||(a[0]=e("legend",{class:"has-text-weight-bold"}," Add Check In ",-1)),a[1]||(a[1]=e("div",{class:"is-flex is-flex-direction-row-reverse"},[e("button",{class:"button is-dark",type:"submit"}," Save ")],-1)),e("div",D,[(m(),d(x,null,C(h,o=>e("div",q,[u(F,{form:o,errors:r.value,defaultValue:v[o.name]},null,8,["form","errors","defaultValue"])])),64))])],8,V)],32)])])]))}};export{M as default};
