import{B as S}from"./BreadCrumb-QusY3eB5.js";import{f as D,v as E}from"./forms-D_1mYhwY.js";import{r as l,m as x,c as o,b as _,a as t,p as B,d as v,F,f as j,u as O,t as V,q as A,g,o as s,j as L,k as N,L as R}from"./index-DhUzF4e6.js";import{t as C,v as q,a as P}from"./utils-RVpx9FsL.js";import{S as h}from"./sweetalert2.esm.all-CIewtpap.js";import"./index.esm-DyswK6GF.js";const z={class:"container"},G={class:"card"},H={class:"card-content"},I=["disabled"],J={class:"columns is-multiline"},K={class:"column is-4"},M={key:2},$={__name:"Edit",setup(Q){const u=l({}),d=l(!1),b=N(),m=A(),f=l(!0),i=l(null),n=l(null);async function y(r){i.data=n.value=null;try{const e=await g.collection("leave").getOne(r);n.value=e}catch(e){e.data.message&&(i.value=e.data.message)}finally{f.value=!1}}x(m.params,()=>{y(m.params.id)},{immediate:!0});async function k(r){r.preventDefault();const e=r.target,c=new FormData(e);let a=C(Object.fromEntries(c.entries()));const p=await q(Object.fromEntries(a.entries()),E);if(p!==!0){u.value=p;return}d.value=!0,u.value={},a.get("is_half")==="true"?a.append("days",.5):a.append("days",P(a.get("leave_from"),a.get("leave_to"))),console.log(a.get("is_half"));try{await g.collection("leave").update(m.params.id,a)}catch(w){h.fire({title:"Error!",text:w.data.message,icon:"error"})}finally{h.fire({title:"Success!",text:"successfully udated leave",icon:"success"}),b.push("/leave")}d.value=!1}return(r,e)=>(s(),o("div",z,[_(S,{links:[{label:"Dashboard",path:"/",isActive:!1},{label:"Leave",path:"/leave",isActive:!1},{label:"Edit",path:"/leave/edit",isActive:!0}]}),t("div",G,[t("div",H,[f.value?(s(),B(R,{key:0})):v("",!0),!f.value&&n.value!==null?(s(),o("form",{key:1,novalidate:"",onSubmit:k},[t("fieldset",{disabled:d.value},[e[0]||(e[0]=t("legend",{class:"has-text-weight-bold"}," Add Employee ",-1)),e[1]||(e[1]=t("div",{class:"is-flex is-flex-direction-row-reverse"},[t("button",{class:"button is-dark",type:"submit"}," Save ")],-1)),t("div",J,[(s(!0),o(F,null,j(O(D),c=>(s(),o("div",K,[_(L,{form:c,errors:u.value,defaultValue:n.value[c.name]},null,8,["form","errors","defaultValue"])]))),256))])],8,I)],32)):v("",!0),i.value!=null?(s(),o("p",M,V(i.value),1)):v("",!0)])])]))}};export{$ as default};
