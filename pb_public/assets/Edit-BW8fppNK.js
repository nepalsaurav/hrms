import{r as n,l as N,m as T,c as l,b as k,a as s,p as I,d as v,F as p,f as _,t as S,g as w,o as t,n as D,h as M,v as R,u as O,j as P,q as $,k as q,L as z}from"./index-DhUzF4e6.js";import{B as J}from"./BreadCrumb-QusY3eB5.js";import{v as G,g as H,f as x,a as K}from"./forms-Lc3CRwVw.js";import"./index.esm-DyswK6GF.js";import{S as B}from"./sweetalert2.esm.all-CIewtpap.js";const Q={class:"container"},U={class:"card"},W={class:"card-content"},X={class:"tabs"},Y=["onClick"],Z={class:"columns is-multiline"},ee={key:2},re={__name:"Edit",setup(ae){const b=$(),E=q(),d=n(!1),u=n(null),f=n(null),c=n("personal_details"),h=n({}),{formModel:m,getForm:C,trimObject:F}=N(),y=n([{label:"Dashboard",path:"/",isActive:!1},{label:"Employee",path:"/employee",isActive:!1},{label:"Edit",path:"/employee",isActive:!1}]),g=n([{name:"personal_details",label:"Personal Details"},{name:"contact_details",label:"Contact Details"},{name:"job_details",label:"Job Details"},{name:"payroll_and_benifits",label:"Payroll and Benefits"},{name:"insurance_information",label:"Insurance Information"},{name:"additional_information",label:"Additional Information"}]);T(()=>b.params.id,A,{immediate:!0});async function A(r){f.value=null,u.value=null,d.value=!0;try{const e=await w.collection("employee").getOne(r);y.value.push({label:e.first_name,path:`/employee/edit/${e.id}`,isActive:!0}),u.value=e}catch(e){e.value=e.data.message}finally{d.value=!1}}function V(r){c.value=r}async function j(r){r.preventDefault();const e=await G(F(),K);if(e!=!0){h.value=e;const o=H(c.value,x,e);o!=null&&(c.value=o);return}const a=C(),i=[m.first_name,m.middle_name,m.last_name].filter(o=>o!=="").join(" ");a.append("full_name",i);try{console.log(a),console.log(m);const o=await w.collection("employee").update(b.params.id,a);console.log(o),B.fire({title:"Success!",text:"Successfully edited employee",icon:"success",confirmButtonColor:"#171717"}),E.push("/employee")}catch(o){const L=o.data.message;B.fire({title:"Error!",text:L,icon:"error"})}}return(r,e)=>(t(),l("div",Q,[k(J,{links:y.value},null,8,["links"]),s("div",U,[s("div",W,[d.value?(t(),I(z,{key:0})):v("",!0),u.value!=null?(t(),l("form",{key:1,novalidate:"",onSubmit:j},[e[0]||(e[0]=s("legend",{class:"has-text-weight-bold"},"Add Employee",-1)),e[1]||(e[1]=s("div",{class:"is-flex is-flex-direction-row-reverse"},[s("button",{class:"button is-dark",type:"submit"}," Save ")],-1)),s("div",X,[s("ul",null,[(t(!0),l(p,null,_(g.value,a=>(t(),l("li",{class:D(a.name===c.value&&"is-active")},[s("a",{onClick:i=>V(a.name)},S(a.label),9,Y)],2))),256))])]),(t(!0),l(p,null,_(g.value,a=>(t(),l("div",null,[M(s("div",Z,[(t(!0),l(p,null,_(O(x)[a.name],i=>(t(),l("div",{class:D(["column",i.type==="rich_text"?"is-12":"is-4"])},[k(P,{form:i,errors:h.value,defaultValue:u.value[i.name]},null,8,["form","errors","defaultValue"])],2))),256))],512),[[R,a.name===c.value]])]))),256))],32)):v("",!0),f.value!=null?(t(),l("p",ee,S(f.value),1)):v("",!0)])])]))}};export{re as default};
