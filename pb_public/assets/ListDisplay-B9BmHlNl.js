import{_ as Y,r as p,x as j,m as Q,A as U,c as l,p as L,d as s,a as u,b as V,t as v,e as G,h as E,u as D,F as x,f as F,q as J,g as $,o as e,y as K,n as W,w as I,E as X,R as Z,k as ee,s as te,L as le}from"./index-DhUzF4e6.js";import{_ as ne,v as oe}from"./index-Dh1WwN9N.js";import{S as y}from"./sweetalert2.esm.all-CIewtpap.js";const ae={key:1},se={class:"box"},ie={key:0,class:"box"},ce={class:"is-flex"},ue={class:"has-text-weight-bold"},re={key:1,class:"scroll-div"},de={class:"has-text-grey"},ve={class:"table is-fullwidth is-striped"},pe={key:0},fe=["checked","indeterminate"],_e={key:0},he={key:0},ke=["value"],ye=["onClick"],me={key:0},ge={key:1},xe={key:2},be={key:3},we={key:0},Ce={key:1},Be={key:6},Le={key:2,class:"mt-4"},De={key:0,class:"has-text-weight-bold"},Fe={key:3,class:"has-text-danger"},Se={__name:"ListDisplay",props:{listHeader:Array,collection:String,filter:Array,detailViewLink:String,routeBack:{type:String},expand:{type:String,default:""},checkBoxAllowed:{type:Boolean,default:!0},filterFuntion:Function},setup(N){const R=ee(),b=J(),h=p(!0),w=p(null),f=p(null),_=p(1),C=p("-created"),m=p(""),i=p([]),g=p(!1),r=p([]),d=N;async function B(a,o="-created",c="",t=!1){t||(h.value=!0);try{const k=await $.collection(d.collection).getList(a,5,{filter:c,sort:o,expand:d.expand});f.value=k,t?r.value.push(...k.items):(r.value=k.items,h.value=!1)}catch{t||(r.value=[],f.value=null),h.value=!1}}j(()=>{S(b.query)}),Q(()=>b.query,(a,o)=>{S(a)}),U(()=>{B(_.value,C.value,m.value,g.value)});function H(){B(_.value,C.value,m.value,g.value)}function M(){_.value<f.value.totalPages&&(_.value+=1,g.value=!0)}function S(a){a.filter!==void 0&&(m.value=a.filter,_.value=1,g.value=!1)}function T(){r.value=[],_.value=1,m.value="",g.value=!1}function A(a,o){let c=[];for(let t=0;t<o.length;t++)a[o[t]]!==""&&c.push(a[o[t]]);return c.join(" ")}function q(a){const o=f.value.page,c=f.value.perPage;return(o-1)*c+(a+1)}function z(a){console.log("select all trigger"),a.target.checked?i.value=r.value:i.value=[]}async function O(){if(!(await y.fire({title:"Are you sure want to delete?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#171717",cancelButtonColor:"#808080",confirmButtonText:"Yes, delete it!"})).isConfirmed||i.value.length===0)return;const o=$.createBatch();i.value.forEach((c,t)=>{o.collection(d.collection).delete(c.id)}),y.fire({title:"Data is deleting ...",allowOutsideClick:!1,didOpen:()=>{y.showLoading()}});try{await o.send(),B(_.value,C.value,m.value),i.value=[],y.close()}catch(c){console.log(c),y.close(),y.fire({title:"Error!",text:c.data.message,icon:"error"}),i.value=[]}}function P(a){R.push(`${d.detailViewLink}/${a.id}`)}return(a,o)=>{const c=te("tempalte");return e(),l(x,null,[h.value?(e(),L(le,{key:0})):s("",!0),!h.value&&f.value?(e(),l("div",ae,[u("div",se,[V(ne,{filter:d.filter,routeBack:d.routeBack,resetList:T,filterFuntion:d.filterFuntion},null,8,["filter","routeBack","filterFuntion"])]),i.value.length>0?(e(),l("div",ie,[u("div",ce,[u("p",ue,v(i.value.length)+" selected out of "+v(r.value.length),1),u("button",{class:"button is-danger is-small ml-4",onClick:O},o[1]||(o[1]=[u("i",{class:"bi bi-archive pr-1"},null,-1),G(" Delete ")]))])])):s("",!0),r.value.length>0?E((e(),l("div",re,[u("p",de,"Total Items: "+v(f.value.totalItems),1),u("table",ve,[u("thead",null,[u("tr",null,[d.checkBoxAllowed?(e(),l("th",pe,[u("input",{class:"custom-checkbox",onClick:z,type:"checkbox",checked:i.value.length===r.value.length,indeterminate:i.value.length>0&&i.value.length<r.value.length},null,8,fe)])):s("",!0),(e(!0),l(x,null,F(d.listHeader,t=>(e(),l(x,null,[t.can!==!1?(e(),l("th",_e,v(t.label),1)):s("",!0)],64))),256))])]),u("tbody",null,[(e(!0),l(x,null,F(r.value,(t,k)=>(e(),l("tr",{key:t.id},[d.checkBoxAllowed?(e(),l("td",he,[E(u("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>i.value=n),value:t,class:"custom-checkbox",type:"checkbox"},null,8,ke),[[K,i.value]])])):s("",!0),(e(!0),l(x,null,F(d.listHeader,n=>(e(),l("td",{class:W({"text-link":n.link}),onClick:Ae=>n.link&&P(t)},[n.type==="serial_number"?(e(),l("span",me,v(q(k)),1)):s("",!0),n.type==="text"?(e(),l("span",ge,v(t[n.name]),1)):s("",!0),n.type==="combined"?(e(),l("span",xe,v(A(t,n.combinedField)),1)):s("",!0),n.type==="date"?(e(),l("span",be,v(t[n.name].split(" ")[0]),1)):s("",!0),n.type==="expand"?(e(),L(c,{key:4},{default:I(()=>[n.isCombinedField?(e(),l("span",we,v(A(t.expand[n.expandCollection],n.fields)),1)):(e(),l("span",Ce,v(t.expand[n.expandCollection][n.expandLabel]),1))]),_:2},1024)):s("",!0),n.type==="custom_component"&&n.can!==!1?(e(),L(X(n.component),{key:5,item:t,header:n,reloadData:H},null,8,["item","header"])):s("",!0),n.type==="action"?(e(),l("span",Be,[V(D(Z),{class:"button is-dark",style:{width:"10px",height:"20px"},to:`${D(b).path}/edit/${t.id}`},{default:I(()=>o[2]||(o[2]=[u("i",{class:"bi bi-pencil",style:{"font-size":"10px"}},null,-1)])),_:2},1032,["to"])])):s("",!0)],10,ye))),256))]))),128))])])])),[[D(oe),M]]):s("",!0)])):s("",!0),!h.value&&w.value===null?(e(),l("div",Le,[r.value.length===0?(e(),l("p",De," no any data to show ")):s("",!0)])):s("",!0),w.value!==null?(e(),l("p",Fe,v(w.value),1)):s("",!0)],64)}}},Ie=Y(Se,[["__scopeId","data-v-b562e5a1"]]);export{Ie as L};
